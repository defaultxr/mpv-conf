#  MPV - mpv.conf
#  deus0ww - 2019-11-17



############
# Playback #
############
[default]
#force-seekable=yes
#merge-files=yes
reset-on-next-file=audio-delay,mute,pause,speed,sub-delay,video-aspect-override,video-pan-x,video-pan-y,video-rotate,video-zoom,volume
resume-playback=no
save-position-on-quit=no
use-filedir-conf=no
write-filename-in-watch-later-config=no
user-agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Safari/605.1.15"



################
# Logs & Paths #
################
[default]
log-file="~/Library/Logs/mpv-running.log"
msg-level=all=warn

icc-cache-dir="/Users/Shared/Library/Caches/mpv/icc/"
gpu-shader-cache-dir="/Users/Shared/Library/Caches/mpv/shader/"



##############
# Screenshot #
##############
[default]
screenshot-format=png
screenshot-tag-colorspace=yes
screenshot-png-compression=8
screenshot-template="%F - %wH-%wM-%wS"

sws-scaler=spline
# sws-allow-zimg=yes
# zimg-scaler=spline36
# zimg-scaler-chroma=spline36



######
# UI #
######
# [builtin-pseudo-gui]
# terminal=no
# force-window=yes
# idle=once
# screenshot-directory=~~desktop/
# [pseudo-gui]
# player-operation-mode=pseudo-gui

[default]
#autofit-larger=98%x98%
#autofit-smaller=50%x50%
#autofit=50%x50%
geometry=-0-0

cursor-autohide-fs-only=yes
cursor-autohide=480
force-window=no
idle=yes
input-doubleclick-time=200
input-right-alt-gr=no
keep-open-pause=no
keep-open=yes
macos-fs-animation-duration=0
native-fs=no
native-keyrepeat=yes

[ww-high-sierra]
macos-title-bar-material=dark

[ww-mojave]
macos-title-bar-material=fullScreen



#######
# OSD #
#######
[default]
osc=no  # Replaced by Thumbnailer OSC
force-rgba-osd-rendering=yes
load-stats-overlay=no
osd-level=1
osd-on-seek=msg-bar

osd-align-y=bottom
osd-bar-align-y=1
osd-margin-x=10
osd-margin-y=14

osd-bar-h=1
osd-bar-w=100
osd-duration=2000
osd-font="Helvetica Neue"
osd-font-size=20
osd-color="#E0F0F0F0"
osd-bold=yes
osd-border-color="#E0000000"
osd-border-size=1.6
osd-blur=0.2
osd-spacing=0.2



###################
# Cache & Demuxer #
###################
[ww-cache-low]
cache-pause-initial=no
demuxer-max-bytes=128MiB         # KiB, MiB
demuxer-max-back-bytes=64MiB     # KiB, MiB

[ww-cache-high]
cache-pause-initial=yes
demuxer-max-bytes=512MiB         # KiB, MiB
demuxer-max-back-bytes=256MiB    # KiB, MiB

[default]
profile=ww-cache-low
stream-buffer-size=1MiB          # KiB, MiB
demuxer-lavf-buffersize=1048576  # Bytes
demuxer-mkv-subtitle-preroll=yes
demuxer-mkv-subtitle-preroll-secs=4
demuxer-mkv-subtitle-preroll-secs-index=8
hr-seek-framedrop=no



#############
# Protocols #
#############
[default]
network-timeout=15

[ww-protocol-local]
profile=ww-cache-low
force-window=yes

[protocol.file]
profile=ww-protocol-local


[ww-protocol-http]
profile=ww-cache-high
force-window=immediate

[protocol.http]
profile=ww-protocol-http

[protocol.https]
profile=ww-protocol-http



##############
# Extensions #
##############
[ww-ext-image]
audio-file-auto=no
sub-auto=no
image-display-duration=inf
loop-file=inf
loop-playlist=inf
force-window=immediate
video-aspect-override=no
video-sync=audio

[extension.bmp]
profile=ww-ext-image
[extension.gif]
profile=ww-ext-image
[extension.jpeg]
profile=ww-ext-image
[extension.jpg]
profile=ww-ext-image
[extension.png]
profile=ww-ext-image
[extension.tif]
profile=ww-ext-image
[extension.tiff]
profile=ww-ext-image
[extension.webp]
profile=ww-ext-image



#############
# Languages # - Disabled: Handled by Language_Switcher script
#############
[default]
# alang=ja,jap,jpn,japanese,th,tha,thai,en,eng,english
# slang=th,tha,thai,en,eng,english
ytdl-raw-options=sub-lang="th,tha,thTH,th-TH,en,eng,enUS,en-US",write-sub=,write-auto-sub=,geo-bypass=,geo-bypass-country=US



#############
# Subtitles #
#############
[ww-subtitle-thai]
profile-desc="WW - Subtitle Settings For Thai"
sub-font="SukhumvitSet-Medium"
sub-font-size=40
sub-border-size=2.4
sub-blur=0.4
sub-spacing=0.4

[ww-subtitle-english]
profile-desc="WW - Subtitle Settings For English"
sub-font="SFProRounded-Medium"
sub-font-size=40
sub-border-size=2.4
sub-blur=0.4
sub-spacing=0.5

[ww-subtitle-bitmap]
profile-desc="WW - Subtitle Settings For Bitmap Type"
blend-subtitles=video

[ww-subtitle-text]
profile-desc="WW - Subtitle Settings For Text Type"
blend-subtitles=no

[default]
profile-desc="WW - Subtitle Settings"
profile=ww-subtitle-thai
sub-auto=fuzzy
sub-file-paths-append=ass
sub-file-paths-append=srt
sub-file-paths-append=sub
sub-file-paths-append=subs
sub-file-paths-append=subtitles
sub-fix-timing=no

sub-color="#E0F0F0F0"
sub-border-color="#E0000000"
sub-gauss=0.6
sub-gray=yes
sub-justify=left
sub-scale=0.75
sub-margin-y=14

sub-ass-force-margins=yes
sub-ass-force-style=Kerning=yes
sub-ass-line-spacing=16
sub-ass-override=force
sub-ass-vsfilter-aspect-compat=no
sub-ass-vsfilter-blur-compat=no
sub-ass-vsfilter-color-compat=no



##################
# Audio Profiles #
##################
[default]
profile-desc="WW - Audio - Common Settings"
volume=50
volume-max=200
ad-lavc-downmix=no
ad-lavc-threads=8

audio-file-auto=fuzzy
audio-channels=stereo
audio-normalize-downmix=yes
audio-resample-filter-size=32  # SWR only
audio-resample-phase-shift=12  # SWR only
audio-resample-cutoff=0.96
audio-resample-linear=yes


[ww-audio-resample-no]
audio-samplerate=0
audio-swresample-o=""

[ww-audio-resample-44]
audio-format=float
audio-samplerate=44100
audio-swresample-o="dither_method=low_shibata:resampler=soxr:cutoff=0.96:precision=33:cheby=1"

[ww-audio-resample-48]
audio-format=float
audio-samplerate=48000
audio-swresample-o="dither_method=low_shibata:resampler=soxr:cutoff=0.96:precision=33:cheby=1"

[ww-audio-resample-96]
audio-format=float
audio-samplerate=96000
audio-swresample-o="dither_method=low_shibata:resampler=soxr:cutoff=0.96:precision=33:cheby=1"

[ww-audio-resample-192]
audio-format=float
audio-samplerate=192000
audio-swresample-o="dither_method=low_shibata:resampler=soxr:cutoff=0.96:precision=33:cheby=1"



##################
# Video Profiles #
##################

# Scaler Comparison: 
#   https://artoriuz.github.io/mpv_upscaling.html

# Profile gpu-hq: 
#   scale=spline36
#   cscale=spline36
#   dscale=mitchell
#   dither-depth=auto
#   correct-downscaling=yes
#   linear-downscaling=yes
#   sigmoid-upscaling=yes
#   deband=yes

[default]
display-fps=60
icc-3dlut-size=256x256x256
icc-contrast=1000
icc-profile-auto=yes
opengl-pbo=yes
swapchain-depth=8
video-sync=display-resample
alpha=no
scaler-lut-size=10
sigmoid-center=0.6
sigmoid-slope=9.0
deband-iterations=4
deband-grain=0
temporal-dither=yes
tscale=box
tscale-window=sphinx
tscale-radius=0.92
tscale-clamp=0.0
interpolation=no
input-ipc-server=/tmp/mpvsocket  # For SVP

[ww-video-mac]
vo=libmpv
cocoa-force-dedicated-gpu=yes
hdr-compute-peak=no
vd-lavc-dr=no

[ww-video-win]
vo=gpu
cocoa-force-dedicated-gpu=no
hdr-compute-peak=auto
vd-lavc-dr=yes


### Video LOW ###
[ww-video-low]
profile-desc="WW - Video - High Performance"
deband=no
dither-depth=no
correct-downscaling=no
linear-downscaling=no
linear-upscaling=no
sigmoid-upscaling=no
hwdec=auto
fbo-format=rgba16
scale=bilinear
cscale=bilinear
dscale=bilinear
vd-lavc-threads=8
glsl-shaders-clr
script-opts-add=Shaders-enabled=no,Thumbnailer-max_workers=3


### Video MID ###
[ww-video-mid]
profile-desc="WW - Video - Mid Quality"
profile=gpu-hq
hwdec=no
fbo-format=rgba16f
scale=robidouxsharp
cscale=robidouxsharp
dscale=robidouxsharp
vd-lavc-threads=12
glsl-shaders-clr
script-opts-add=Shaders-enabled=no,Thumbnailer-max_workers=9


### Video HIGH ###
[ww-video-high]
profile-desc="WW - Video - High Quality Base"
profile=gpu-hq
hwdec=no
fbo-format=rgba16f
cscale=ewa_robidouxsharp
dscale=ewa_robidouxsharp
vd-lavc-threads=16
script-opts-add=Thumbnailer-max_workers=12

[ww-video-high-no-shaders]
profile-desc="WW - Video - High Quality w/o Shaders"
profile=ww-video-high
scale=ewa_robidouxsharp  # ewa_lanczossharp has visible ringing
script-opts-add=Shaders-enabled=no

[ww-video-high-shaders]
profile-desc="WW - Video - High Quality w/ Shaders"
profile=ww-video-high
scale=ewa_lanczossharp   # Only used when scaling > 4x
linear-downscaling=no    # For SSimDownscaler.glsl
sigmoid-upscaling=no     # For adaptive-sharpen.glsl
script-opts-add=Shaders-enabled=yes



###########
# Scripts #
###########
[ww-retina]
script-opts-add=osc-scalefullscreen=1.50,osc-scalewindowed=1.50,Mac_Window-display_w=1920,Mac_Window-display_h=1080,Mac_Window-scale_factor=2

[ww-non-retina]
script-opts-add=osc-scalefullscreen=0.75,osc-scalewindowed=0.75,Mac_Window-display_w=2560,Mac_Window-display_h=1440,Mac_Window-scale_factor=1



#####################
# Hardware Profiles #
#####################
[ww-macpro-2008]
profile=ww-high-sierra
profile=ww-audio-resample-192
profile=ww-video-mac,ww-video-high-shaders
profile=ww-retina

[ww-mbp-2009]
profile=ww-high-sierra
profile=ww-audio-resample-no
profile=ww-video-mac,ww-video-low
profile=ww-non-retina

[ww-mbp-2012]
profile=ww-mojave
profile=ww-audio-resample-96
profile=ww-video-mac,ww-video-mid
profile=ww-non-retina

[ww-pc]
profile=ww-audio-resample-no
profile=ww-video-win,ww-video-low



#####################
# Effective Profile #
#####################
[default]
# profile=ww-macpro-2008
  profile=ww-mbp-2012
# profile=ww-mbp-2009
# profile=ww-pc
